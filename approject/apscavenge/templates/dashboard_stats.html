{% extends "layout-nav.html" %}
{% load static %}

{% block custom_stylesheet %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block title_ext %}Dashboard - {% endblock %}

{% block main_class %} class="mb-5"{% endblock %}

{% block content %}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'js/dashboard.js' %}" defer></script>
<script type="text/javascript">
    /* Varaibles declaration for external javascript file */
    const dashboardURL = '{% url "dashboard" %}';
    let requestModel = '{{ table_data.current_model }}';
    let areasStatsData = null;
    let areasWeekylData = null;
    {% if areas_stats is not None %}
    areasStatsData = {{ areas_stats|safe }};
    areasWeekylData = {{ areas_weekly|safe }};
    {% endif %}
</script>

<div class="sidebar">
    <ul id="ul-sidebar">
        <a href="{% url 'dashboard' %}"><li>Tables</li></a>
        <a href="{% url 'dashboard-stats' %}"><li>Stats</li></a>
        <a class="sidebar-hidden" id="a-sidebar-toggle"><li style="margin-top: 50%">Close</li></a>
    </ul>
</div>
<div class="mt-5">
    <div class="page-indicator">
        APScavenge <b>> 
        <span class="underlined">Dashboard</b></span>
        > Stats
        <span class="sidebar-hidden" id="sidebar-toggle-container"> > <button id="button-sidebar-toggle">Toggle Sidebar</button></span>
    </div>
    <div class="container">
        <div class="row">
            {% for area in areas_stats %}
            <div class="col-lg-4 col-md-6 mb-3">
                <canvas id="{{ area }}" class="doughnut-chart"></canvas>
            </div>
            {% endfor %}

            {% for area in areas_weekly %}
            <div style="min-width: 64%;" class="col-lg-4 col-md-6 mb-3">
                <canvas id="{{ area }}" class="line-chart"></canvas>
            </div>
            {% endfor %}
        </div>
        <div class="row">
            {% for key, values in areas_captures.items %}
            <div class="col" style="display: inline-block;">
                <h3>Latest Captures</h3>
                {% for detail in values %}
                <div style="display: flex; justify-content: space-between;">
                    <span class="pr-2">{{ detail.0 }} - {{ detail.1 }}</span>
                    <span class="pl-2 pr-2" style="font-size: 0.8rem; border-left: 2px solid #ef9a38;">{{ detail.2 }}</span>
                </div>
                <hr style="margin: 7px 0px;"/>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
        {% if areas_stats|length == 0 %}
        <div class="center">
            <svg class="mb-4" fill="#ef9a38" width="70" aria-hidden="true" focusable="false" data-prefix="fal" data-icon="info-circle" class="svg-inline--fa fa-info-circle fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm-36 344h12V232h-12c-6.627 0-12-5.373-12-12v-8c0-6.627 5.373-12 12-12h48c6.627 0 12 5.373 12 12v140h12c6.627 0 12 5.373 12 12v8c0 6.627-5.373 12-12 12h-72c-6.627 0-12-5.373-12-12v-8c0-6.627 5.373-12 12-12zm36-240c-17.673 0-32 14.327-32 32s14.327 32 32 32 32-14.327 32-32-14.327-32-32-32z"></path></svg>
            <h5>No current stats</h5>
        </div>
        {% endif %}
    </div>
</div>

{% endblock %}